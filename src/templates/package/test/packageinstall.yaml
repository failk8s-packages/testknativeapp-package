#@ load("@ytt:data", "data")

---
apiVersion: packaging.carvel.dev/v1alpha1
kind: PackageInstall
metadata:
  name: #@ "{}-package".format(data.values.package.name)
  namespace: #@ "{}-package".format(data.values.package.name)
spec:
  serviceAccountName: #@ "{}-sa".format(data.values.package.name)
  packageRef:
    refName: #@ "{}.{}".format(data.values.package.name, data.values.package.domain)
    versionSelection:
      constraints: #@ "{}".format(data.values.package.version)
      prereleases: {}
  values:
  - secretRef:
      name: #@ "{}-config".format(data.values.package.name)